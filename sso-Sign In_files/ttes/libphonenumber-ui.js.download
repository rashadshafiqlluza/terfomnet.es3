function onlyDigits(t){return(t.match(/\d/g)||[]).join("")}const EMAIL_ADDRESS_VALID_AFTER_AT_REGEX=/^[A-Za-z0-9.\-]$/,EMAIL_ADDRESS_VALID_BEFORE_AT_REGEX=/^[A-Za-z0-9!#$%&'*+\/=?^_`{|}~.\-]$/,EMAIL_ADDRESS_VALID_BEFORE_AT_SPECIAL_CHARS_REGEX=/^[!#$%&'*+\/=?^_`{|}~]$/,EMAIL_ADDRESS_VALID_REGEX=/[A-Za-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[A-Za-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[A-Za-z0-9](?:[A-Za-z0-9-]*[A-Za-z0-9])?\.)+[A-Za-z0-9](?:[A-Za-z0-9-]*[A-Za-z0-9])?/;class ElementUI{constructor(t){this.element=t,this.bindEvents(),this.cacheValidState=!1,this.ignoreUpdate=!1}bindEvents(){const t=this,e=this.keyDown.bind(this),i=this.keyUp.bind(this),s=this.paste.bind(this),n=this.update.bind(this);this.element.onblur=e=>{t.ignoreUpdate||t.lastValue===t.value||n(),void 0!==t.onblur&&t.onblur(e)},this.element.onchange=e=>{t.ignoreUpdate||t.lastValue===t.value||n(),void 0!==t.onchange&&t.onchange(e)},this.element.onkeydown=i=>{t.ignoreUpdate=!0,e(i),void 0!==t.onkeydown&&t.onkeydown(i),t.ignoreUpdate=!1},this.element.onkeyup=e=>{t.ignoreUpdate=!0,i(e),void 0!==t.onkeyup&&t.onkeyup(e),t.ignoreUpdate=!1},this.element.onpaste=e=>{t.ignoreUpdate=!0,s(e),void 0!==t.onpaste&&t.onpaste(e),t.ignoreUpdate=!1}}get selectionEnd(){return this.element.selectionEnd}set selectionEnd(t){this.element.selectionEnd=t}get selectionStart(){return this.element.selectionStart}set selectionStart(t){this.element.selectionStart=t}get value(){return this.element.value||""}set value(t){const e=null==t?"":t;if(this.element.value=e,this.cacheValidState&&this.lastValue!==e){this.lastValue=e;const t=this._isValid;if(this.isValid=this.calculatedIsValid(),this.isValid===t)return;this.isValid?void 0!==this.onValid&&this.onValid():void 0!==this.onInvalid&&this.onInvalid()}}keyDown(){}keyUp(){}get onblur(){return this._onblur}set onblur(t){this._onblur=t}get onchange(){return this._onchange}set onchange(t){this._onchange=t}get onclick(){return this.element.onclick}set onclick(t){this.element.onclick=t}get onfocus(){return this.element.onfocus}set onfocus(t){this.element.onfocus=t}get onkeydown(){return this._onkeydown}set onkeydown(t){this._onkeydown=t}get onkeyup(){return this._onkeyup}set onkeyup(t){this._onkeyup=t}get onpaste(){return this._onpaste}set onpaste(t){this._onpaste=t}paste(){}update(){}calculatedIsValid(){}get cacheValidState(){return this._cacheValidState}set cacheValidState(t){this.cacheValidState!==t&&(this._cacheValidState=t,t?(this.isValid=this.calculatedIsValid(),this.lastValue=this.value):this.isValid=void 0)}get isValid(){return this.cacheValidState?this._isValid:this.calculatedIsValid()}set isValid(t){this._isValid=t}get onInvalid(){return this._onInvalid}set onInvalid(t){this.cacheValidState=!0,this._onInvalid=t}get onValid(){return this._onValid}set onValid(t){this.cacheValidState=!0,this._onValid=t}}class PhoneNumberUI extends ElementUI{constructor(t,e){super(t),this.countryCode=e,this.update()}get asYouTypeNumber(){return new libphonenumber.AsYouType(this.countryCode).input(this.value)}get internationalNumber(){const t=libphonenumber.parsePhoneNumberFromString(this.value,this.countryCode);return void 0===t?"":t.number}get nationalNumber(){const t=libphonenumber.parsePhoneNumberFromString(this.value,this.countryCode);return void 0===t?"":t.formatNational()}setValue(t,e){let i=(t.slice(0,e).match(/\d|\+/g)||[]).length,s=(t.match(/\d|\+/g)||[]).join("");s=new libphonenumber.AsYouType(this.countryCode).input(s),this.value=s;for(let t=0;t<s.length;t++)if(/\d|\+/.test(s.slice(t,t+1))){if(0===i)return this.selectionStart=t,void(this.selectionEnd=t);i--}this.selectionStart=s.length,this.selectionEnd=s.length}keyDown(t){const e=t.key;if(!0===t.ctrlKey||!0===t.metaKey||["Tab","Enter","Escape","End","Home","ArrowDown","ArrowLeft","ArrowRight","ArrowUp"].includes(e))return;t.preventDefault(),t.stopPropagation();const i=this.value,s=this.selectionStart,n=this.selectionEnd;if("Backspace"===e||"Delete"===e){let t=(i.slice(0,s).match(/\d|\+/g)||[]).join(""),l=(i.slice(n).match(/\d|\+/g)||[]).join("");s!==n||("Backspace"===e&&t.length>0?t=t.slice(0,t.length-1):"Delete"===e&&l.length>0&&(l=l.slice(1))),this.setValue(t+l,t.length)}else if(/^\d$/.test(e))this.setValue(i.slice(0,s)+e+i.slice(n),s+1);else if("+"===e){if((i.slice(0,s).match(/\d|\+/g)||[]).join("").length>0)return;this.setValue("+"+(i.slice(n).match(/\d/g)||[]).join(""),1)}else s!==n&&this.setValue(i.slice(0,s)+i.slice(n),s);this.element.dispatchEvent(new Event("input"))}paste(t){let e=t.clipboardData;void 0===e&&(e=window.clipboardData);let i="";void 0!==e&&(i=e.getData("Text"));const s=this.value;let n=this.selectionStart;const l=s.slice(0,n)+i,a=[];for(const t of l)("+"===t&&0===a.length||/^\d$/.test(t))&&a.push(t);n=a.length;for(const t of s.slice(this.selectionEnd))("+"===t&&0===a.length||/^\d$/.test(t))&&a.push(t);this.setValue(a.join(""),n),t.preventDefault(),t.stopPropagation(),this.element.dispatchEvent(new Event("input"))}update(){this.ignoreUpdate=!0;let t=this.value,e=this.selectionStart;null==e&&(e=t.length),this.setValue(t,e),this.ignoreUpdate=!1}calculatedIsValid(){const t=libphonenumber.parsePhoneNumberFromString(this.value,this.countryCode);return void 0!==t&&t.isValid()}}class EmailAddressUI extends ElementUI{constructor(t){super(t),this.update()}setValue(t,e){let i=!1,s=[...t.slice(0,e)].filter(t=>i?EMAIL_ADDRESS_VALID_AFTER_AT_REGEX.test(t):"@"===t?(i=!0,!0):EMAIL_ADDRESS_VALID_BEFORE_AT_REGEX.test(t)).join("");const n=s.length;s+=[...t.slice(e)].filter(t=>i?EMAIL_ADDRESS_VALID_AFTER_AT_REGEX.test(t):"@"===t?(i=!0,!0):EMAIL_ADDRESS_VALID_BEFORE_AT_REGEX.test(t)).join(""),this.value=s,this.selectionStart=n,this.selectionEnd=n}keyDown(t){const e=t.key;if(!0===t.ctrlKey||!0===t.metaKey||EMAIL_ADDRESS_VALID_AFTER_AT_REGEX.test(e)||["Tab","Enter","Escape","End","Home","Backspace","Delete","ArrowDown","ArrowLeft","ArrowRight","ArrowUp"].includes(e))return;let i=this.value,s=this.selectionStart||i.length;const n=this.selectionEnd||s,l=i.slice(0,s);if(l.includes("@")){if(EMAIL_ADDRESS_VALID_BEFORE_AT_SPECIAL_CHARS_REGEX.test(e)&&n!==s)return t.preventDefault(),void t.stopPropagation()}else if(EMAIL_ADDRESS_VALID_BEFORE_AT_SPECIAL_CHARS_REGEX.test(e))return;const a=i.slice(n);"@"===e?(i=l.replace("@","")+"@",s=i.length,i+=[...a].filter(t=>EMAIL_ADDRESS_VALID_AFTER_AT_REGEX.test(t)).join("")):/^[A-Z]$/.test(e)?(i=l+e.toLowerCase()+a,s=l.length+1):s!==n&&(i=l+a,s=l.length),this.value=i,this.selectionStart=s,this.selectionEnd=s,t.preventDefault(),t.stopPropagation(),this.element.dispatchEvent(new Event("input"))}keyUp(t){if(this.cacheValidState){const t=this.value;if(t!==this.lastValue){let e=this.selectionStart;null==e&&(e=t.length),this.setValue(t,e)}}}paste(t){let e=t.clipboardData;void 0===e&&(e=window.clipboardData);let i="";void 0!==e&&(i=e.getData("Text").toLowerCase());let s=this.value,n=this.selectionStart,l=s.slice(0,n);const a=s.slice(this.selectionEnd);i.includes("@")&&(l=l.replace("@",""),n=l.length),n+=i.length,s=l+i+a,this.setValue(s,n),t.preventDefault(),t.stopPropagation(),this.element.dispatchEvent(new Event("input"))}update(){this.ignoreUpdate=!0;const t=this.value;let e=this.selectionStart;null==e&&(e=t.length),this.setValue(t,e),this.ignoreUpdate=!1}calculatedIsValid(){return EMAIL_ADDRESS_VALID_REGEX.test(this.value)}}class CodeUI extends ElementUI{constructor(t,e){super(t),this.formatArray=e||[],this.update()}get code(){return onlyDigits(this.value)}set code(t){this.setValue(t,t.length)}setValue(t,e){let i=(t.slice(0,e).match(/\d/g)||[]).length;const s=(t.match(/\d/g)||[]).join("");let n="",l=0;if(s.length>0){for(const t of this.formatArray)if(Number.isInteger(t)){if(l+t>s.length)break;n+=s.slice(l,l+t),l+=t}else n+=t;l<s.length&&(n+=s.slice(l,s.length))}this.value=n;for(let t=0;t<n.length;t++)if(/\d/.test(n.slice(t,t+1))){if(0===i)return this.selectionStart=t,void(this.selectionEnd=t);i--}this.selectionStart=n.length,this.selectionEnd=n.length}keyDown(t){const e=t.key;if(!0===t.ctrlKey||!0===t.metaKey||["Tab","Enter","Escape","End","Home","ArrowDown","ArrowLeft","ArrowRight","ArrowUp"].includes(e))return;const i=this.value,s=this.selectionStart,n=this.selectionEnd;if("Backspace"===e||"Delete"===e){let t=(i.slice(0,s).match(/\d/g)||[]).join(""),l=(i.slice(n).match(/\d/g)||[]).join("");s!==n||("Backspace"===e&&t.length>0?t=t.slice(0,t.length-1):"Delete"===e&&l.length>0&&(l=l.slice(1))),this.setValue(t+l,t.length)}else/^\d$/.test(e)?this.setValue(i.slice(0,s)+e+i.slice(n),s+1):s!==n&&this.setValue(i.slice(0,s)+i.slice(n),s);t.preventDefault(),t.stopPropagation(),this.element.dispatchEvent(new Event("input"))}paste(t){let e=t.clipboardData;void 0===e&&(e=window.clipboardData);let i="";void 0!==e&&(i=e.getData("Text"));let s=this.value,n=this.selectionStart;const l=s.slice(0,n),a=s.slice(this.selectionEnd);i=(i.match(/\d/g)||[]).join(""),s=l+i+a,n+=i.length,this.setValue(s,n),t.preventDefault(),t.stopPropagation(),this.element.dispatchEvent(new Event("input"))}update(){this.ignoreUpdate=!0;const t=this.value;let e=this.selectionStart;null==e&&(e=t.length),this.setValue(t,e),this.ignoreUpdate=!1}calculatedIsValid(){if(void 0===this.minimumLength&&void 0===this.maximumLength)return;const t=this.code.length;return!(void 0!==this.minimumLength&&t<this.minimumLength||void 0!==this.maximumLength&&t>this.maximumLength)}set length(t){this.minimumLength=t,this.maximumLength=t}get maximumLength(){return this._maximumLength}set maximumLength(t){this._maximumLength=t,this.cacheValidState=!0}get minimumLength(){return this._minimumLength}set minimumLength(t){this._minimumLength=t,this.cacheValidState=!0}}