$("#user-email, #email").blur((function(){var e=$(this).parents("fieldset").length?$(this).parents("fieldset"):$(this).parents("form"),o=$(".message-box-error",e),a=$("ul",o),n=a.length,t=n?"<li/>":"<div/>",i=n?a:o,l=0===o.children().length||0===a.children().length,s=$("meta[name='domain-suggester-prompt']").attr("content");function r(){o.removeAttr("style"),$("body").removeClass("page-error"),o.trigger("isHidden")}$(this).mailcheck({suggested:function(a,n){var c=$(t,{class:"domain-suggestion",html:s.replace(/\{\{corrected_email\}\}/,' <a href="#update" class="domain-suggestion-address">'+n.address+'@<span class="domain">'+n.domain+"</span></a>"),click:function(e){$(this).remove(),l&&r(),a.val(n.full),a.parent(".field-error").removeClass("field-error"),e.preventDefault()}});$(".domain-suggestion",e).remove(),i.prepend(c),o.show(),o.trigger("isVisible"),a.parent(".field").addClass("field-error"),$("body").addClass("page-error")},empty:function(o){$(".domain-suggestion",e).length&&($(".domain-suggestion",e).remove(),l&&r(),o.parent(".field-error").removeClass("field-error"))}})})),jQuery.fn.mailcheck=function(e,o){var a=["yahoo.com","google.com","hotmail.com","gmail.com","me.com","aol.com","mac.com","live.com","comcast.net","googlemail.com","msn.com","facebook.com","verizon.net","sbcglobal.net","att.net","gmx.com","mail.com","squareup.com","ymail.com","pacbell.net","hotmail.co.uk","yahoo.co.uk","yahoo.ca","hotmail.ca","live.ca","shaw.ca","cgocable.ca","cogeco.ca","bell.net","bell.ca","sympatico.ca","rogers.com","videotron.ca","astlink.ca","dccnet.com","personainternet.com","cabletv.on.ca","amtelecom.net","xcelco.on.ca","telus.net","i.softbank.jp","softbank.ne.jp","docomo.ne.jp","mopera.net","vodafone.ne.jp","ezweb.ne.jp","disney.ne.jp","biz.ezweb.ne.jp","ido.ne.jp","emnet.ne.jp","emobile.ne.jp","pdx.ne.jp","wilcom.com","wcm.ne.jp","yahoo.co.jp","live.jp","yahoo.com.au","google.com.au","hotmail.com.au","gmail.com.au","me.com.au","aol.com.au","mac.com.au","live.com.au","comcast.net.au","googlemail.com.au","msn.com.au","facebook.com.au","verizon.net.au","sbcglobal.net.au","att.net.au","gmx.com.au","mail.com.au","squareup.com.au","ymail.com.au","pacbell.net.au"];if("object"==typeof e&&void 0===o)e.domains=e.domains||a;else{var n=e;(e=o).domains=n||a}var t=Kicksend.mailcheck.suggest(encodeURI(this.val()),e.domains);t?e.suggested&&e.suggested(this,t):e.empty&&e.empty(this)};var Kicksend={mailcheck:{threshold:3,suggest:function(e,o){e=e.toLowerCase();var a=this.splitEmail(e),n=this.findClosestDomain(a.domain,o);return!!n&&{address:a.address,domain:n,full:a.address+"@"+n}},findClosestDomain:function(e,o){for(var a,n=3,t=null,i=0;i<o.length;i++){if(e===o[i])return!1;(a=this.stringDistance(e,o[i]))<n&&(n=a,t=o[i])}return n<=this.threshold&&null!==t&&t},stringDistance:function(e,o){if(null==e||0===e.length)return null==o||0===o.length?0:o.length;if(null==o||0===o.length)return e.length;for(var a=0,n=0,t=0,i=0;a+n<e.length&&a+t<o.length;){if(e[a+n]==o[a+t])i++;else{n=0,t=0;for(var l=0;l<5;l++){if(a+l<e.length&&e[a+l]==o[a]){n=l;break}if(a+l<o.length&&e[a]==o[a+l]){t=l;break}}}a++}return(e.length+o.length)/2-i},splitEmail:function(e){var o=e.split("@");if(o.length<2)return!1;for(var a=0;a<o.length;a++)if(""===o[a])return!1;return{domain:o.pop(),address:o.join("@")}}}};